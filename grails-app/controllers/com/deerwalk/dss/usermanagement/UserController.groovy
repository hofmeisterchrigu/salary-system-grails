package com.deerwalk.dss.usermanagementimport grails.plugins.springsecurity.Securedimport grails.plugins.springsecurity.SpringSecurityService@Secured(['ROLE_USER','ROLE_ADMIN'])class UserController {	def springSecurityService	def changePassword() {		def user = springSecurityService.currentUser		def oldPassword=params.oldPassword		def newPassword=params.newPassword		if(springSecurityService.encodePassword(oldPassword).equals(user.password)){			def dssUserInstance = DssUser.get(springSecurityService.currentUser.id)			dssUserInstance.password = newPassword			if (!dssUserInstance.save(flush: true)) {				flash.message=dssUserInstance.errors			}else{				springSecurityService.currentUser.password=springSecurityService.encodePassword(newPassword)				flash.message="password changed!"			}		}else{			flash.message="fail to change password"		}		redirect action: 'index',controller: 'dashBoard'	}}